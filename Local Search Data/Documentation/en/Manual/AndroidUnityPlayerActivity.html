<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script type="text/javascript" src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" charset="UTF-8" data-domain-script="6e91be4c-3145-4ea2-aa64-89d716064836"></script><script type="text/javascript">
					function OptanonWrapper() { }
				</script><script>var offline=(location.href.indexOf('docs.unity3d.com')==-1)?true:false;if(!offline){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-5V25JL6');}</script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual:  Extending the UnityPlayerActivity Java Code</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="https://docs.unity3d.com/StaticFilesConfig/UnityVersionsInfo.js"></script><script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=1631881794"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=1631881794"></script><script type="text/javascript" src="docdata/toc.js?ts=1631881794"></script><script type="text/javascript" src="docdata/global_toc.js?ts=1631881794"></script><link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=1631881794">
<link rel="stylesheet" href="../StaticFilesManual/css/prism.css">
<script src="../StaticFilesManual/js/prism.js"></script><script src="/StaticFilesConfig/feedback/feedback.js"></script><script src="../StaticFilesManual/js/jquery.sidebar.min.js"></script><link rel="stylesheet" href="../StaticFilesManual/css/mobileoptimisation.css">
<script src="../StaticFilesManual/js/mobileoptimisation.js"></script>
</head>
<body>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div id="DocsAnalyticsData" data-area="none" data-pagetype="manual"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="toggle version-number" id="VersionNumber" data-target=".otherversionscontent">
                                Version: <b>2020.3</b><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">
<ul id="OtherVersionsContentUl"></ul>
<div id="otherVersionsLegend"><ul>
<li>
<div id="supportedColour" class="legendBox"></div>Supported</li>
<li>
<div id="notFoundColour" class="legendBox"></div>Legacy</li>
</ul></div>
</div>
<div id="VersionSwitcherArrow" class="arrow versionSwitcherArrow"></div>
</div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/AndroidUnityPlayerActivity.html">English</a></li>
<li><a href="/cn/current/Manual/AndroidUnityPlayerActivity.html">中文</a></li>
<li><a href="/ja/current/Manual/AndroidUnityPlayerActivity.html">日本語</a></li>
<li><a href="/es/current/Manual/AndroidUnityPlayerActivity.html">Español</a></li>
<li><a href="/kr/current/Manual/AndroidUnityPlayerActivity.html">한국어</a></li>
<li><a href="/ru/current/Manual/AndroidUnityPlayerActivity.html">Русский</a></li>
</ul></div>
</div></div>
</div></div>
<div class="mobileLogo"><a href="https://docs.unity3d.com"></a></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc" id="customScrollbar">
<h2>Unity Manual</h2>
<div class="search-form sidebar-search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" id="mobileSearchBtn" class="submit" value="Search">
</form></div>
<div class="toggle version-number sidebar-version-switcher" id="VersionNumber" data-target=".otherversionscontent"><form id="otherVersionsContentMobileForm"><div class="ui-field-contain">
<label for="select-native-4">Version: 2020.3</label><select name="select-native-4" id="versionsSelectMobile"><option>Select a different version</option>
<optgroup id="versionsWithThisPageMobile" label="Versions with this page"></optgroup>
<optgroup id="versionsWithoutThisPageMobile" label="Versions without this page"></optgroup></select>
</div></form></div>
<div class="lang-switcher"><div class="current toggle" data-target=".lang-list">
<div class="lbl">Language
:                <span class="b">English</span>
</div>
<div class="arrow"></div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/AndroidUnityPlayerActivity.html">English</a></li>
<li><a href="/cn/current/Manual/AndroidUnityPlayerActivity.html">中文</a></li>
<li><a href="/ja/current/Manual/AndroidUnityPlayerActivity.html">日本語</a></li>
<li><a href="/es/current/Manual/AndroidUnityPlayerActivity.html">Español</a></li>
<li><a href="/kr/current/Manual/AndroidUnityPlayerActivity.html">한국어</a></li>
<li><a href="/ru/current/Manual/AndroidUnityPlayerActivity.html">Русский</a></li>
</ul></div>
</div></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html"> Unity User Manual 2020.3 (LTS)</a></li>
<li><a href="PlatformSpecific.html">Platform development  </a></li>
<li><a href="android.html"> Android</a></li>
<li><a href="PluginsForAndroid.html"> Building and using plug-ins for Android</a></li>
<li> Extending the UnityPlayerActivity Java Code</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="AndroidJARPlugins.html"></a></span><div class="tip">JAR plug-ins</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="AndroidNativePlugins.html"></a></span><div class="tip">Native (C++) plug-ins for Android</div>
</div>
</div></div>
<div id="_leavefeedback"></div>
<h1>Extending the UnityPlayerActivity Java Code</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>Sections on this page:</p>

<ul>
<li><a href="#ExtendingUnityPlayerActivity">Extending the UnityPlayerActivity file</a></li>
<li><a href="#StartupArguments">Specifying Unity startup arguments from a custom UnityPlayerActivity file</a></li>
<li><a href="#UnityPlayerActivityExample">UnityPlayerActivity example file with sample manifest</a></li>
</ul>

<p><a name="ExtendingUnityPlayerActivity"></a></p>

<h2>Extending the UnityPlayerActivity file</h2>

<p>When you develop a Unity Android application, you can use <span class="tooltip"><strong>plug-ins</strong><span class="tooltiptext">A set of code created outside of Unity that creates functionality in Unity. There are two kinds of plug-ins you can use in Unity: Managed plug-ins (managed .NET assemblies created with tools like Visual Studio) and Native plug-ins (platform-specific native code libraries). <a class="tooltipMoreInfoLink" href="Plugins.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Plug-in">Glossary</a></span></span></span> to extend the standard <code>UnityPlayerActivity</code> class (the primary Java class for the Unity Player on Android, similar to <code>AppController.mm</code> on Unity iOS). An application can override all basic interactions between the Android OS and the Unity Android application.</p>

<p>To override the default activity:</p>

<ul>
<li>Create a new <code>Activity</code> which derives from <code>UnityPlayerActivity</code> (see Android documentation on <a href="http://developer.android.com/reference/android/app/Activity.html">Activity</a>);</li>
<li>Modify the <a href="android-manifest.html">Android Manifest</a> to have the new <code>Activity</code> as the application’s entry point.</li>
</ul>

<p>The easiest way to achieve this is to export your project from Unity, then make the necessary modifications to the <code>UnityPlayerActivity</code> class in Android Studio. Or, you can create a new class, extend it, modify <code>AndroidManifest.xml</code> in the unityLibrary project, and then replace <code>UnityPlayerActivity</code> with your class.</p>

<p>To create a plug-in with your new Activity and add it to your Project, you must perform the following steps:
1. Extend the UnityPlayerActivity file. This is best done in Android Studio after exporting project from Unity. There are several options:
* The .java or .kt file containing your activity class can put put into Unity project
* Create Java library containing your class, compile it and put resulting .jar file into Unity project
* Create Android library containint your class; this library can be put into Unity project in source code from (by naming the folder to have .androidlib “extension”) or it can be compiled and resulting .aar be put into Unity project</p>

<p>To create a plug-in with your new <code>Activity</code> and add it to your Project, perform the following steps:</p>

<ol>
<li>
<p>Extend the UnityPlayerActivity file. The best way to do this is in Android Studio after exporting your project from Unity. You then have the following options:</p>

<ul>
<li>Put the .java or .kt file that contains your activity class directly into Unity project By default, the file is located at:</li>
</ul>

<p><strong>macOS:</strong></p>

<p><code>/Applications/Unity/Unity.app/Contents/PlaybackEngines/AndroidPlayer/src/com/unity3d/player</code></p>

<p><strong>Windows:</strong></p>

<p>
<code>C:\Program Files\Unity\Editor\Data\PlaybackEngines\AndroidPlayer\src\com\unity3d\player</code> </p>

<ul>
<li>Create a Java library that contains your class, compile it and put the resulting .jar file into your Unity project</li>
<li>
<a href="https://developer.android.com/studio/projects/android-library">Create an Android library</a> that contains your class. You can then put this library into your Unity project in your source code. To do this, give your folder a name with an .androidlib extension, or it can be compile it and put the resulting .aar file in your Unity project</li>
</ul>
</li>
<li><p>Create a new Android manifest to set the new <code>Activity</code> as the entry point of your application, then place the <code>AndroidManifest.xml</code> file in the <code>Assets/Plugins/Android</code> folder of your Project.</p></li>
</ol>

<p><a name="#StartupArguments"></a></p>

<h2>Specifying Unity startup arguments from a custom UnityPlayerActivity file</h2>

<p>When you extend <code>UnityPlayerActivity</code>, you can override <code>String UnityPlayerActivity.updateUnityCommandLineArguments</code>(String cmdLine) to pass startup arguments to Unity.</p>

<p>
<code>UnityPlayerActivity</code> calls this method during startup. It accepts the current command line arguments, which can be null or empty, and returns a new string of command line arguments to pass to Unity.</p>

<p>For a general overview of Unity command line interface, see <a href="CommandLineArguments.html">Command line arguments</a>.</p>

<p>The following example demonstrates how to use this to select the Graphics API based on the current device:</p>

<pre><code class="lang-java">package com.company.product;
import com.unity3d.player.UnityPlayerActivity;
import android.os.Bundle;
import android.os.Build;

public class OverrideExample extends UnityPlayerActivity {
    private boolean preferVulkan() {
        // Use Vulkan on Google Pixel devices
        if (Build.MANUFACTURER.equals(&quot;Google&quot;) &amp;&amp; Build.MODEL.startsWith(&quot;Pixel&quot;))
            return true;
        else
            return false;
    }

    private boolean preferES2() {
        // Use OpenGL ES 2.0 on devices that run Android 5.1 or older
        if (Build.VERSION.SDK_INT &lt;= Build.VERSION_CODES.LOLLIPOP_MR1)
            return true;
        else
            return false;
    }

    private String appendCommandLineArgument(String cmdLine, String arg) {
        if (arg == null || arg.isEmpty())
            return cmdLine;
        else if (cmdLine == null || cmdLine.isEmpty())
            return arg;
        else
            return cmdLine + &quot; &quot; + arg; 
    } 

    @Override protected String updateUnityCommandLineArguments(String cmdLine)
    {
        if (preferVulkan())
            return appendCommandLineArgument(cmdLine, &quot;-force-vulkan&quot;);
        else if (preferES2())
            return appendCommandLineArgument(cmdLine, &quot;-force-gles20&quot;);
        else
            return cmdLine; // let Unity pick the Graphics API based on PlayerSettings
    }

    @Override protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
    }
}
</code></pre>

<p><a name="UnityPlayerActivityExample"></a></p>

<h1>UnityPlayerActivity example file</h1>

<p>The following is an example of a <code>UnityPlayerActivity</code> file:</p>

<pre><code class="lang-java">OverrideExample.java:
package com.company.product;
import com.unity3d.player.UnityPlayerActivity;
import android.os.Bundle;
import android.util.Log;

public class OverrideExample extends UnityPlayerActivity {
  protected void onCreate(Bundle savedInstanceState) {
    // call UnityPlayerActivity.onCreate()
    super.onCreate(savedInstanceState);
    // print debug message to logcat
    Log.d(&quot;OverrideActivity&quot;, &quot;onCreate called!&quot;);
  }
  public void onBackPressed()
  {
    // instead of calling UnityPlayerActivity.onBackPressed() we just ignore the back button event
    // super.onBackPressed();
  }
}
</code></pre>

<p>The corresponding <code>AndroidManifest.xml</code> might look like the following:</p>

<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; package=&quot;com.company.product&quot;&gt;
  &lt;application android:icon=&quot;@drawable/app_icon&quot; android:label=&quot;@string/app_name&quot;&gt;
    &lt;activity android:name=&quot;com.YourPackage.name.OverrideExample&quot;
             android:label=&quot;@string/app_name&quot;
             android:configChanges=&quot;fontScale|keyboard|keyboardHidden|locale|mnc|mcc|navigation|orientation|screenLayout|screenSize|smallestScreenSize|uiMode|touchscreen&quot;&gt;
        &lt;intent-filter&gt;
            &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;
            &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
        &lt;/intent-filter&gt;
    &lt;/activity&gt;
  &lt;/application&gt;
&lt;/manifest&gt;

</code></pre>

<p>To create a plug-in with your new Activity and add it to your Project, you must perform the following steps:</p>

<ol>
<li>Extend the UnityPlayerActivity file. This is best done in Android Studio after exporting project from Unity. There are several options:

<ul>
<li>The .java or .kt file containing your activity class can put put into Unity project.</li>
<li>Create Java library containing your class, compile it and put resulting .jar file into Unity project.</li>
<li>Create Android library containint your class; this library can be put into Unity project in source code from (by naming the folder to have .androidlib “extension”) or it can be compiled and resulting .aar be put into Unity project.</li>
</ul>
</li>
<li>Create a new Android Manifest to set the new Activity as the entry point of your application, then place the AndroidManifest.xml file in the Assets/Plugins/Android folder of your Project.</li>
</ol>

<hr>

<ul>
<li><span class="page-history">Added new code sample in 2019.2.</span></li>
<li><span class="page-history">Updated AndroidManifest example for 2019.3 Unity and up</span></li>
</ul>
<div id="_content"></div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="AndroidJARPlugins.html"></a></span><div class="tip">JAR plug-ins</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="AndroidNativePlugins.html"></a></span><div class="tip">Native (C++) plug-ins for Android</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2021 Unity Technologies. Publication Date: 2021-09-17.</div>
<div class="menu">
<a href="https://learn.unity.com/">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
